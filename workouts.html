<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>GreenBite — Workouts</title>
<link rel="stylesheet" href="main.css">
<style>
  /* Responsive video container */
  .video-container {
    position: relative;
    padding-bottom: 56.25%; /* 16:9 ratio */
    height: 0;
    overflow: hidden;
    margin-top: 1.5rem;
    border-radius: 8px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
  }
  .video-container iframe {
    position: absolute;
    top:0;
    left:0;
    width:100%;
    height:100%;
  }
</style>
</head>
<body>
<header class="nav-wrap">
  <div class="logo">GreenBite</div>
  <nav id="nav">
    <a href="index.html">Home</a>
    <a href="recipes.html">Recipes</a>
    <a href="calculator.html">Calculator</a>
    <a href="workouts.html" class="active">Workouts</a>
    <a href="mindfulness.html">Mindfulness</a>
    <a href="contact.html">Contact</a>
  </nav>
</header>

<main class="container">
  <h1>Workout Generator</h1>
  <form id="workout-form">
    <label>Body part 
      <select id="bodypart">
        <option value="full">Full Body</option>
        <option value="arms">Arms</option>
        <option value="legs">Legs</option>
        <option value="core">Core</option>
      </select>
    </label>
    <label>Equipment 
      <select id="equip">
        <option value="none">None</option>
        <option value="dumbbells">Dumbbells</option>
        <option value="band">Resistance Band</option>
      </select>
    </label>
    <button type="button" id="gen-btn">Generate</button>
  </form>

  <!-- Workout Video Section -->
  <h2>Workout Video Guide</h2>
  <div class="video-container">
    <iframe 
      src="https://www.youtube.com/embed/U9ENCvFf9yQ"
      title="Workout Video"
      frameborder="0"
      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
      allowfullscreen>
    </iframe>
  </div>

  <div id="plan" class="plan hidden">
    <h2>Your Plan</h2>
    <ol id="ex-list"></ol>
    <div id="timer-area" class="hidden">
      <h3 id="current-ex"></h3>
      <div id="countdown">00:00</div>
      <button id="start-ex">Start</button>
      <button id="next-ex" class="hidden">Next</button>
    </div>
  </div>
</main>

<footer>© GreenBite</footer>

<script src="data.js"></script>
<script src="common.js"></script>
<script>
function genWorkout(){
  const bp = document.getElementById('bodypart').value;
  const eq = document.getElementById('equip').value;
  const pool = workouts.filter(w=> (w.body===bp||bp==='full'&&w.body==='full') && (w.equipment==='any' || w.equipment===eq));
  const chosen = [];
  for(let i=0;i<5 && pool.length;i++){
    const idx = Math.floor(Math.random()*pool.length);
    chosen.push(pool[idx]);
    pool.splice(idx,1);
  }
  const ol = document.getElementById('ex-list'); ol.innerHTML='';
  chosen.forEach((c,i)=>{
    const li = document.createElement('li');
    li.innerHTML = `<strong>${c.name}</strong> — ${c.duration}s`;
    li.dataset.duration = c.duration;
    ol.appendChild(li);
  });
  document.getElementById('plan').classList.remove('hidden');
  saveToLocal('last_workout', {date:new Date().toISOString(), plan: chosen});
}

document.getElementById('gen-btn').addEventListener('click', genWorkout);

// Timer functionality
let timerInterval, currentIndex=0, currentList=[];
document.getElementById('plan').addEventListener('click', (e)=>{
  if(e.target.id==='start-ex') startExercise();
});
function startExercise(){
  const items = document.querySelectorAll('#ex-list li');
  currentList = Array.from(items);
  if(!currentList.length) return;
  currentIndex = 0;
  document.getElementById('timer-area').classList.remove('hidden');
  nextExercise();
}
function nextExercise(){
  if(currentIndex >= currentList.length){
    document.getElementById('current-ex').textContent = 'Done!';
    document.getElementById('countdown').textContent = '00:00';
    window.clearInterval(timerInterval);
    return;
  }
  const li = currentList[currentIndex];
  const name = li.querySelector('strong').textContent, dur = +li.dataset.duration;
  document.getElementById('current-ex').textContent = name;
  let t = dur;
  document.getElementById('countdown').textContent = String(t).padStart(2,'0') + ':00'.slice(3);
  window.clearInterval(timerInterval);
  const display = document.getElementById('countdown');
  timerInterval = setInterval(()=>{
    if(t<=0){ clearInterval(timerInterval); currentIndex++; nextExercise(); return; }
    t--;
    display.textContent = String(t).padStart(2,'0') + ':00'.slice(3);
  }, 1000);
}

document.getElementById('workout-form').addEventListener('submit', (e)=>e.preventDefault());
</script>
</body>
</html>

